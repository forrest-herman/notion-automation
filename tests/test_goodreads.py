from goodreads import *
from utils import read_from_file


def test_rating():
    assert get_rating_from_text(rating_text='it was ok') == '2'
    assert get_rating_from_text(rating_text='really liked it yes!') == None


def test_get_books_list_data():
    html = read_from_file('tests/ressources/goodreads_book_list.html')

    # output
    book_list = [
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1460477682l/25494343.jpg', 'title': 'Lady Midnight', 'series': 'The Dark Artifices, #1', 'book_url': '/book/show/25494343-lady-midnight', 'author_name': 'Cassandra Clare', 'author_url': '/author/show/150038.Cassandra_Clare', 'rating': '5', 'review': 'None', 'date_started': '2023-05-01', 'date_read': '2023-05-15'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1666441294l/17699859.jpg', 'title': 'Chain of Thorns', 'series': 'The Last Hours, #3', 'book_url': '/book/show/17699859-chain-of-thorns', 'author_name': 'Cassandra Clare', 'author_url': '/author/show/150038.Cassandra_Clare', 'rating': '5', 'review': 'None', 'date_started': '2023-04-07', 'date_read': '2023-04-20'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1604591461l/17699855.jpg', 'title': 'Chain of Iron', 'series': 'The Last Hours, #2', 'book_url': '/book/show/17699855-chain-of-iron', 'author_name': 'Cassandra Clare', 'author_url': '/author/show/150038.Cassandra_Clare', 'rating': '5', 'review': 'None', 'date_started': '2023-03-26', 'date_read': '2023-04-06'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1571379245l/17699853.jpg', 'title': 'Chain of Gold', 'series': 'The Last Hours, #1', 'book_url': '/book/show/17699853-chain-of-gold', 'author_name': 'Cassandra Clare', 'author_url': '/author/show/150038.Cassandra_Clare', 'rating': '5', 'review': 'None', 'date_started': '2023-02-28', 'date_read': '2023-03-26'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1465761302l/28257707.jpg', 'title': 'The Subtle Art of Not Giving a F*ck: A Counterintuitive Approach to Living a Good Life', 'series': None, 'book_url': '/book/show/28257707-the-subtle-art-of-not-giving-a-f-ck', 'author_name': 'Mark Manson', 'author_url': '/author/show/8529755.Mark_Manson', 'rating': '3', 'review': 'None', 'date_started': '2023-02-17', 'date_read': '2023-02-27'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1582135294l/36809135.jpg', 'title': 'Where the Crawdads Sing', 'series': None, 'book_url': '/book/show/36809135-where-the-crawdads-sing', 'author_name': 'Delia Owens', 'author_url': '/author/show/7043934.Delia_Owens', 'rating': '5', 'review': 'None', 'date_started': '2023-02-12', 'date_read': '2023-02-16'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1663805647l/136251.jpg', 'title': 'Harry Potter and the Deathly Hallows', 'series': 'Harry Potter, #7', 'book_url': '/book/show/136251.Harry_Potter_and_the_Deathly_Hallows', 'author_name': 'J.K. Rowling', 'author_url': '/author/show/1077326.J_K_Rowling', 'rating': '5', 'review': 'None', 'date_started': '2023-01-29', 'date_read': '2023-02-06'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1587697303l/1.jpg', 'title': 'Harry Potter and the Half-Blood Prince', 'series': 'Harry Potter, #6', 'book_url': '/book/show/1.Harry_Potter_and_the_Half_Blood_Prince', 'author_name': 'J.K. Rowling', 'author_url': '/author/show/1077326.J_K_Rowling', 'rating': '5', 'review': 'None', 'date_started': '2023-01-18', 'date_read': '2023-01-29'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1546910265l/2.jpg', 'title': 'Harry Potter and the Order of the Phoenix', 'series': 'Harry Potter, #5', 'book_url': '/book/show/2.Harry_Potter_and_the_Order_of_the_Phoenix', 'author_name': 'J.K. Rowling', 'author_url': '/author/show/1077326.J_K_Rowling', 'rating': '5', 'review': 'None', 'date_started': '2022-12-30', 'date_read': '2023-01-17'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1554006152l/6.jpg', 'title': 'Harry Potter and the Goblet of Fire', 'series': 'Harry Potter, #4', 'book_url': '/book/show/6.Harry_Potter_and_the_Goblet_of_Fire', 'author_name': 'J.K. Rowling', 'author_url': '/author/show/1077326.J_K_Rowling', 'rating': '5', 'review': 'None', 'date_started': '2022-12-10', 'date_read': '2022-12-24'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1630547330l/5.jpg', 'title': 'Harry Potter and the Prisoner of Azkaban', 'series': 'Harry Potter, #3', 'book_url': '/book/show/5.Harry_Potter_and_the_Prisoner_of_Azkaban', 'author_name': 'J.K. Rowling', 'author_url': '/author/show/1077326.J_K_Rowling', 'rating': '5', 'review': 'None', 'date_started': '2022-12-01', 'date_read': '2022-12-08'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1474169725l/15881.jpg', 'title': 'Harry Potter and the Chamber of Secrets', 'series': 'Harry Potter, #2', 'book_url': '/book/show/15881.Harry_Potter_and_the_Chamber_of_Secrets', 'author_name': 'J.K. Rowling', 'author_url': '/author/show/1077326.J_K_Rowling', 'rating': '5', 'review': 'None', 'date_started': '2022-11-23', 'date_read': '2022-11-27'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1170803558l/72193._SX50jpg', 'title': 'Harry Potter and the Philosopher’s Stone', 'series': 'Harry Potter, #1', 'book_url': '/book/show/72193.Harry_Potter_and_the_Philosopher_s_Stone', 'author_name': 'J.K. Rowling', 'author_url': '/author/show/1077326.J_K_Rowling', 'rating': '5', 'review': 'None', 'date_started': '2022-11-16', 'date_read': '2022-11-22'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1456172607l/22299763.jpg', 'title': 'Crooked Kingdom', 'series': 'Six of Crows, #2', 'book_url': '/book/show/22299763-crooked-kingdom', 'author_name': 'Leigh Bardugo', 'author_url': '/author/show/4575289.Leigh_Bardugo', 'rating': '5', 'review': 'None', 'date_started': '2022-10-31', 'date_read': '2022-11-14'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1651710803l/23437156.jpg', 'title': 'Six of Crows', 'series': 'Six of Crows, #1', 'book_url': '/book/show/23437156-six-of-crows', 'author_name': 'Leigh Bardugo', 'author_url': '/author/show/4575289.Leigh_Bardugo', 'rating': '5', 'review': 'None', 'date_started': '2022-10-19', 'date_read': '2022-10-31'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1610744543l/52190991.jpg', 'title': 'Any Way the Wind Blows', 'series': 'Simon Snow, #3', 'book_url': '/book/show/52190991-any-way-the-wind-blows', 'author_name': 'Rainbow Rowell', 'author_url': '/author/show/4208569.Rainbow_Rowell', 'rating': '5', 'review': 'None', 'date_started': '2022-09-29', 'date_read': '2022-10-10'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1552666477l/44017627.jpg', 'title': 'Wayward Son', 'series': 'Simon Snow, #2', 'book_url': '/book/show/44017627-wayward-son', 'author_name': 'Rainbow Rowell', 'author_url': '/author/show/4208569.Rainbow_Rowell', 'rating': '4', 'review': '4.5 stars. Easy, fun read. Relatable familiar characters. Who doesn’t love a road trip? Great overall!', 'date_started': '2022-09-16', 'date_read': '2022-09-28'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1455989059l/28356624.jpg', 'title': 'Carry On', 'series': None, 'book_url': '/book/show/28356624-carry-on', 'author_name': 'Rainbow Rowell', 'author_url': '/author/show/4208569.Rainbow_Rowell', 'rating': '5', 'review': 'None', 'date_started': '2022-09-09', 'date_read': '2022-09-16'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1657897729l/59571699.jpg', 'title': 'Love on the Brain', 'series': None, 'book_url': '/book/show/59571699-love-on-the-brain', 'author_name': 'Ali Hazelwood', 'author_url': '/author/show/21098177.Ali_Hazelwood', 'rating': '5', 'review': 'None', 'date_started': '2022-09-05', 'date_read': '2022-09-07'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1526376554l/29386918.jpg', 'title': 'Wildcard', 'series': 'Warcross, #2', 'book_url': '/book/show/29386918-wildcard', 'author_name': 'Marie Lu', 'author_url': '/author/show/4342215.Marie_Lu', 'rating': '3', 'review': '3.5', 'date_started': '2022-08-16', 'date_read': '2022-09-01'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1533058119l/41014903.jpg', 'title': 'Warcross', 'series': 'Warcross, #1', 'book_url': '/book/show/41014903-warcross', 'author_name': 'Marie Lu', 'author_url': '/author/show/4342215.Marie_Lu', 'rating': '4', 'review': 'None', 'date_started': '2022-08-10', 'date_read': '2022-08-15'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1618913179l/54985743.jpg', 'title': 'People We Meet on Vacation', 'series': None, 'book_url': '/book/show/54985743-people-we-meet-on-vacation', 'author_name': 'Emily Henry', 'author_url': '/author/show/13905555.Emily_Henry', 'rating': '4', 'review': 'None', 'date_started': '2022-07-31', 'date_read': '2022-08-07'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1545494980l/40916679.jpg', 'title': "A Good Girl's Guide to Murder", 'series': "A Good Girl's Guide to Murder, #1", 'book_url': '/book/show/40916679-a-good-girl-s-guide-to-murder', 'author_name': 'Holly Jackson', 'author_url': '/author/show/18229614.Holly_Jackson', 'rating': '4', 'review': 'None', 'date_started': '2022-07-14', 'date_read': '2022-07-22'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1589881197l/52867387.jpg', 'title': 'Beach Read', 'series': None, 'book_url': '/book/show/52867387-beach-read', 'author_name': 'Emily Henry', 'author_url': '/author/show/13905555.Emily_Henry', 'rating': '4', 'review': 'None', 'date_started': '2022-07-02', 'date_read': '2022-07-09'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1638867089l/58690308.jpg', 'title': 'Book Lovers', 'series': None, 'book_url': '/book/show/58690308-book-lovers', 'author_name': 'Emily Henry', 'author_url': '/author/show/13905555.Emily_Henry', 'rating': '4', 'review': 'None', 'date_started': '2022-06-23', 'date_read': '2022-07-02'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1548201335l/42201431.jpg', 'title': 'The Unhoneymooners', 'series': None, 'book_url': '/book/show/42201431-the-unhoneymooners', 'author_name': 'Christina Lauren', 'author_url': '/author/show/6556689.Christina_Lauren', 'rating': '3', 'review': 'None', 'date_started': '2022-06-19', 'date_read': '2022-06-23'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1611937942l/56732449.jpg', 'title': 'The Love Hypothesis', 'series': None, 'book_url': '/book/show/56732449-the-love-hypothesis', 'author_name': 'Ali Hazelwood', 'author_url': '/author/show/21098177.Ali_Hazelwood', 'rating': '4', 'review': 'None', 'date_started': '2022-06-09', 'date_read': '2022-06-17'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1612451534l/44084762.jpg', 'title': 'Our Violent Ends', 'series': 'These Violent Delights, #2', 'book_url': '/book/show/44084762-our-violent-ends', 'author_name': 'Chloe Gong', 'author_url': '/author/show/18899059.Chloe_Gong', 'rating': '4', 'review': 'None', 'date_started': '2022-05-30', 'date_read': '2022-06-09'},
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1580958058l/50892212.jpg', 'title': 'These Violent Delights', 'series': 'These Violent Delights, #1', 'book_url': '/book/show/50892212-these-violent-delights', 'author_name': 'Chloe Gong', 'author_url': '/author/show/18899059.Chloe_Gong', 'rating': '4', 'review': 'None', 'date_started': '2022-05-04', 'date_read': '2022-05-19'}, 
        {'cover_url': 'https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1612546028l/52535769.jpg', 'title': 'Gods & Monsters', 'series': 'Serpent & Dove, #3', 'book_url': '/book/show/52535769-gods-monsters', 'author_name': 'Shelby Mahurin', 'author_url': '/author/show/17999118.Shelby_Mahurin', 'rating': '5', 'review': 'None', 'date_started': '2022-04-23', 'date_read': '2022-05-01'}
    ]

    assert get_books_list_data_from_html(html) == book_list